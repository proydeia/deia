generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgres://default:HnVxZN1SDea2@ep-misty-snow-a4608mqj-pooler.us-east-1.aws.neon.tech/verceldb?sslmode=require"
}

model Organization {
  name     String  @id
  phone    String?
  email    String?
  address  String?
  maxUsers Int
  aproved  Boolean @default(false)
  users    User[]
}

model User {
  email         String       @id
  adm           Boolean
  password      String
  organization  String
  patients      Patient[]
  organizations Organization @relation(fields: [organization], references: [name], onDelete: Cascade)
}

model Patient {
  id           Int          @id @default(autoincrement())
  extrainfo    String?
  medic        String
  peso         Float
  altura       Float
  nacimiento   DateTime     @db.Date
  sexo         Int
  name         String
  users        User         @relation(fields: [medic], references: [email], onDelete: Cascade)
  spirometries Spirometry[]
}

model Spirometry {
  id                Int      @id @default(autoincrement())
  patient           Int
  date              DateTime @db.Date
  gold              Boolean  @default(false)
  gli               Boolean  @default(false)
  fev1              Float?
  fev1pred          Float?
  fvc               Float?
  fvcpred           Float?
  obstruction       Int?
  obstructionai     Float?
  restriction       Int?
  restrictionai     Float?
  correctionobsGold Int      @default(-1)
  correctionobsGLI  Int      @default(-1)
  correctionresGold Int      @default(-1)
  correctionresGLI  Int      @default(-1)
  enjson            Int      @default(0)
  patients          Patient  @relation(fields: [patient], references: [id], onDelete: Cascade)
}
